{
  "experiment_run": {
    "experiment_id": "40bbd71d-85bc-4461-9f60-1b4fc55d9de1",
    "variant_name": "feature_ae_loss_scorer",
    "model_name": "vae_feawad",
    "model_imp": "Custom (Proposed)",
    "architecture": "VAE",
    "config_type": "vae_feawad_default_configs",
    "model_cate": "proposed",
    "description": "VAE_FEAWAD experiment with feature_ae_loss_scorer on shuttle"
  },
  "datasets": {
    "experiment_id": "40bbd71d-85bc-4461-9f60-1b4fc55d9de1",
    "contamination_rate": 0.02,
    "shuffle": {
      "train": false,
      "test": false
    },
    "split": {
      "train": 0.8,
      "test": 0.2,
      "stratify": true
    },
    "preprocessing": {
      "numerical": "minmax",
      "categorical": "onehot",
      "handle_missing": true
    },
    "name": "shuttle",
    "input_dim": 9,
    "N": 49097,
    "anomaly_ratio": 0.08,
    "weakly_supervision": 120
  },
  "training": {
    "random_seed": 42,
    "pre_training": {
      "enabled": true,
      "dataset": "normal_only",
      "optimizer": {
        "name": "Adam",
        "lr": 0.0001
      },
      "clipnorm": null,
      "loss": "mean_squared_error",
      "batch_size": 512,
      "steps_per_epoch": 20,
      "epochs": 100
    },
    "main_training": {
      "enabled": true,
      "dataset": "mixed",
      "optimizer": {
        "name": "Adam",
        "lr": 0.0001
      },
      "clipnorm": null,
      "loss": "feawad_multi_loss",
      "batch_size": 512,
      "steps_per_epoch": 20,
      "epochs": 30
    },
    "checkpoint": {
      "save_best_only": true,
      "save_weights_only": true
    },
    "experiment_id": "40bbd71d-85bc-4461-9f60-1b4fc55d9de1"
  },
  "evaluation": {
    "runs": 10,
    "random_seeds": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9
    ],
    "metrics": [
      "auc",
      "ap"
    ],
    "mode": "weakly_supervised",
    "experiment_id": "40bbd71d-85bc-4461-9f60-1b4fc55d9de1"
  },
  "model": {
    "experiment_id": "40bbd71d-85bc-4461-9f60-1b4fc55d9de1",
    "variant": "feature_ae_loss_scorer",
    "model_name": "vae_feawad",
    "encoder_type": null,
    "freeze_encoder": null,
    "pre_training": true,
    "dataset_name": "shuttle",
    "input_dim": 9,
    "latent_dim": 64,
    "features": [
      "encoder_output",
      "reconstruction_error",
      "normalized_residual",
      "latent_mu",
      "latent_logvar",
      "latent_z",
      "latent_variance",
      "latent_std",
      "latent_precision",
      "latent_residual",
      "feature_residual",
      "latent_deviation",
      "latent_direction",
      "kld",
      "elbo"
    ],
    "encoder": [
      {
        "type": "Input",
        "units": 9
      },
      {
        "type": "Dense",
        "units": 9,
        "activation": "relu",
        "initializer": "glorot_normal",
        "use_bias": true,
        "name": "ain"
      },
      {
        "type": "Dense",
        "units": 128,
        "activation": "relu",
        "initializer": "glorot_normal",
        "use_bias": true,
        "name": "ae1"
      },
      {
        "type": "Dense",
        "units": "latent_dim",
        "activation": "relu",
        "initializer": "glorot_normal",
        "use_bias": true,
        "name": "encoder_output"
      }
    ],
    "decoder": [
      {
        "type": "Input",
        "units": "len(z_latent)"
      },
      {
        "type": "Dense",
        "units": 128,
        "activation": "relu",
        "initializer": "glorot_normal",
        "use_bias": true,
        "name": "ad1"
      },
      {
        "type": "Dense",
        "units": 9,
        "activation": "relu",
        "initializer": "glorot_normal",
        "use_bias": true,
        "name": "decoder_output"
      }
    ],
    "sampling": {
      "input": {
        "type": "Input",
        "units": "latent_dim"
      },
      "mu": {
        "type": "Dense",
        "units": "latent_dim",
        "activation": "linear",
        "initializer": "glorot_normal",
        "use_bias": true,
        "name": "z_mu"
      },
      "logvar": {
        "type": "Dense",
        "units": "latent_dim",
        "activation": "linear",
        "initializer": "glorot_normal",
        "use_bias": true,
        "name": "z_logvar"
      },
      "reparameterization": {
        "formula": "mu + eps * exp(0.5 * logvar)",
        "name": "z_latent"
      }
    },
    "scoring_network": [
      {
        "type": "Input",
        "units": "len(extracted_features)"
      },
      {
        "units": 256,
        "activation": "relu",
        "initializer": "glorot_normal",
        "use_bias": true,
        "name": "hl2"
      },
      {
        "op": "Concat",
        "inputs": [
          "hl2",
          "sub_norm2"
        ],
        "axis": 1
      },
      {
        "units": 32,
        "activation": "relu",
        "initializer": "glorot_normal",
        "use_bias": true,
        "name": "hl3"
      },
      {
        "op": "Concat",
        "inputs": [
          "hl3",
          "sub_norm2"
        ],
        "axis": 1
      },
      {
        "units": 1,
        "activation": "linear",
        "initializer": "glorot_normal",
        "use_bias": true,
        "name": "score_output"
      }
    ],
    "loss_function": {
      "name": "vae_feawad_loss",
      "description": "Combination of reconstruction, KL divergence, & weakly-supervised feature encoding",
      "components": {
        "reconstruction_loss": "MSE(x_input, vae_reconstruction)",
        "kl_divergence": "0.5 * sum(exp(logvar) + mu^2 - 1 - logvar)",
        "weak_label_loss": "(1 - y_true) * (|score| + ||residual||) + y_true * (|max(margin - score, 0)| + |max(margin - ||residual||, 0)|)"
      },
      "formula": "L = recon_loss(x_input, vae_reconstruction) + KL(z_mu, z_logvar) + components.weak_label_loss(score, y_true)",
      "hyperparams": {
        "confidence_margin": 5.0,
        "kl_weight": 1.0,
        "recon_weight": 1.0,
        "weak_loss_weight": 1.0
      }
    }
  }
}